# 2ì£¼ì°¨ (section2)

## ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ê³¼ ì„¤ê³„

- íšŒì›
    - íšŒì› ê°€ì… ë° ì¡°íšŒ
    - íšŒì›ì€ ì¼ë°˜ê³¼ vip ë“±ê¸‰
    - ë°ì´í„°ëŠ” ìì²´ ë°ì´í„° í˜¹ì€ ì™¸ë¶€ ë°ì´í„° ì‚¬ìš©(ë¯¸í™•ì •)
- ì£¼ë¬¸ê³¼ í• ì¸ì •ì±…
    - íšŒì›ì€ ì£¼ë¬¸ ê°€ëŠ¥
    - íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ì •ì±…
    - í• ì¸ì •ì±…ì€ vipëŠ” ë¬´ì¡°ê±´ 1000ì›í• ì¸(ì¶”í›„ë³€ê²½ê°€ëŠ¥)
    - í• ì¸ì •ì±… ë³€ê²½ ê°€ëŠ¥ì„± ë†’ìŒ

â†’ ë¯¸í™•ì • í˜¹ì€ ë³€ê²½ê°€ëŠ¥í•œ ì‚¬í•­ë“¤ì´ ìˆë‹¤ â†’ ê°ì²´ì§€í–¥í”„ë¡œê·¸ë˜ë°í•˜ë©´ë¨

- ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³ , êµ¬í˜„ì²´ë¥¼ ì–¸ì œë“  ê°ˆì•„ë¼ìš¸ìˆ˜ ìˆë„ë¡ ê°œë°œí•˜ì
- ìŠ¤í”„ë§ì€ ë‚˜ì¤‘ì— í• ê²ƒ, ì§€ê¸ˆì€ ìˆœìˆ˜ ìë°”ë¡œ êµ¬í˜„

## íšŒì› ë„ë©”ì¸ ì„¤ê³„

- íšŒì› ë„ë©”ì¸ í˜‘ë ¥ ê´€ê³„(ë„ë©”ì¸ì— ëŒ€í•œ í° ê·¸ë¦¼)
    
    <img width="522" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 24 29" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/21ea6e2b-8ef7-410b-a97d-cbff4689bbef">
    
    - íšŒì› ì €ì¥ì†Œë¥¼ í˜„ì¬ ìì²´ êµ¬ì¶•í•  ìˆ˜ë„ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™í• ìˆ˜ë„ìˆìŒ (ë¯¸í™•ì •)
    - ì¸í„°í˜ì´ìŠ¤ : íšŒì› ì €ì¥ì†Œ
    - êµ¬í˜„ì²´ : ì¶”í›„ì— ì •í•´ì§€ëŠ” ì €ì¥ì†Œ ë°©ì‹(ì¼ë‹¨ì€ ë©”ëª¨ë¦¬ íšŒì› ì €ì¥ì†Œë¡œ ê°œë°œì€ í•´ë‘ê³ , ì¶”í›„ì— ì •í•´ì§€ëŠ”ëŒ€ë¡œ ë³€ê²½)

- íšŒì› í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨(ì‹¤ì œ êµ¬í˜„ ë ˆë²¨)
    
    <img width="526" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 27 51" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/95f1ad54-c551-4700-b837-fdc88b99d491">
    
    - íšŒì› ì„œë¹„ìŠ¤ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê³ , êµ¬í˜„ì²´ë¥¼ ë§Œë“¦(implement)
    - ìœ„ íšŒì› ì €ì¥ì†Œê°€ memberRepositoryê°€ ë¨(ì¸í„°í˜ì´ìŠ¤)
    - ê·¸ë¦¬ê³  ë©”ëª¨ë¦¬ë¡œ í• ì§€, ë””ë¹„ë¡œ í• ì§€ëŠ” êµ¬í˜„ì²´ë¡œ ê²°ì •(ì¶”í›„ì— ê²°ì •, ì¼ë‹¨ì€ ë©”ëª¨ë¦¬ë°©ì‹)

- íšŒì› ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨(ì‹¤ì œ ì„œë²„ì— ì˜¬ë¼ì™”ì„ ë•Œ, ê°ì²´ê°„ì˜ ë©”ëª¨ë¦¬ ì°¸ì¡°ê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€)
    
    <img width="655" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 31 09" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/51ef55ba-8b27-443a-bd88-034c23985a4f">
    
    - íšŒì› ì„œë¹„ìŠ¤ : MemberServiceImpl

## íšŒì› ë„ë©”ì¸ ê°œë°œ

- member íŒ¨í‚¤ì§€
    - Grade(`enum`)
        
        ```java
        public enum Grade {
            BASIC,
            VIP
        }
        ```
        
    - Member(`class`)
        
        ```java
        package hello.core.member;
        
        public class Member {
            private Long id;
            private String name;
            private Grade grade;
        
            public Member(Long id, String name, Grade grade) {
                this.id = id;
                this.name = name;
                this.grade = grade;
            }
        
            public Long getId() {
                return id;
            }
        
            public void setId(Long id) {
                this.id = id;
            }
        
            public String getName() {
                return name;
            }
        
            public void setName(String name) {
                this.name = name;
            }
        
            public Grade getGrade() {
                return grade;
            }
        
            public void setGrade(Grade grade) {
                this.grade = grade;
            }
        }
        
        ```
        
    - MemberRepository(`interface`)
        
        ```java
        package hello.core.member;
        
        public interface MemberRepository {
            void save(Member member);
            Member findById(Long memberId);
        }
        
        ```
        
    - MemoryMemberRepository(`class`, MemberRepository êµ¬í˜„ì²´)
        
        ```java
        package hello.core.member;
        
        import java.util.HashMap;
        import java.util.Map;
        
        public class MemoryMemberRepository implements MemberRepository{
        
            //ì €ì¥ì†Œë‹ˆê¹Œ mapê°™ì€ê²Œ ìˆì–´ì•¼ë¨
            //ì‹¤ë¬´ì—ì„œëŠ” concurrent hashmapì„ ì¨ì•¼ë¨, ë™ì‹œì„±ì´ìŠˆ(ë™ì‹œì— ì ‘ê·¼í•˜ëŠ” ì´ìŠˆ)
            private static Map<Long, Member> store = new HashMap<>();
            @Override
            public void save(Member member) {
                store.put(member.getId(), member);
            }
        
            @Override
            public Member findById(Long memberId) {
                return store.get(memberId);
            }
        }
        ```
        
    - MemberService(`interface`)
        
        ```java
        package hello.core.member;
        
        public interface MemberService {
            void join(Member member);
        
            Member fineMember(Long memberId);
        }
        
        ```
        
    - MemberServiceImpl
        
        ```java
        package hello.core.member;
        
        public class MemberServiceImpl implements MemberService {
        
            //ê°€ì…ì„ í•˜ê³  ë©¤ë²„ë¥¼ ì°¾ìœ¼ë ¤ë©´ memberRepository interface(memberRepository)ê°€ í•„ìš”í•¨ -> êµ¬í˜„ì²´ë„ í•„ìš”í•¨(MemoryMemberRespository)
            private final MemberRepository memberRepository = new MemoryMemberRepository();
        
            @Override
            public void join(Member member) {
                memberRepository.save(member);
        
            }
        
            @Override
            public Member fineMember(Long memberId) {
                return memberRepository.findById(memberId);
            }
        }
        
        ```
        
    
    - ConcurrentHashmap
        - bucketë³„ë¡œ ë™ê¸°í™”ë¥¼ ì§„í–‰í•˜ë¯€ë¡œ lockì„ ì•ˆê±´ë‹¤.
        
        <img width="766" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_18 47 53" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/5ae1d9b6-6685-49f6-99f9-64c1ccdb026b">
        
    
    - HashMap
        - í•œ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•  ë•Œ, ë‚˜ë¨¸ì§€ ìŠ¤ë ˆë“œë¥¼ lock ê±°ë¯€ë¡œ ì•ˆì „í•˜ì§€ë§Œ, ì„±ëŠ¥ì´ ì•ˆì¢‹ìŒ
        
        <img width="795" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_18 47 15" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/1e09db73-e97a-4c2c-acdc-149b079c600c">
        
    
    <aside>
    ğŸ’¬ êµ¬í˜„ì²´ì™€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì„œë¡œ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì— ë„£ëŠ” ê²ƒì´ ì¢‹ì§€ë§Œ, ê°„ë‹¨í•œ ì˜ˆì œì´ë¯€ë¡œ ê°™ì´ ë„£ìŒ
    
    </aside>
    
- memberService í…ŒìŠ¤íŠ¸ì½”ë“œ

```java
package hello.core.member;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class MemberServiceTest {

    MemberService memberService = new MemberServiceImpl();
    @Test
    void join() {

        //given(ì´ëŸ° ì´ëŸ° í™˜ê²½ì´ ì£¼ì–´ì¡Œì„ ë•Œ)
        Member member = new Member(1L, "memberA", Grade.VIP);

        //when(ì´ë ‡ê²Œ í–ˆì„ë•Œ)
        memberService.join(member);
        Member findMember = memberService.fineMember(1L);

        //then(ì´ë ‡ê²Œ ëœë‹¤)
        Assertions.assertThat(member).isEqualTo(findMember);

    }
}
```

## ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ì„¤ê³„

- ì£¼ë¬¸ ë„ë©”ì¸ ì—­í• 
    
    <img width="405" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 36 54" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/dee9a8b5-32b9-4eef-8f72-8dc6e8767804">
    
    - ì£¼ë¬¸ ìƒì„± : í´ë¼ì´ì–¸íŠ¸ëŠ” ì£¼ë¬¸ ì„œë¹„ìŠ¤ì— ì£¼ë¬¸ ìƒì„±ì„ ìš”ì²­í•œë‹¤.
    - íšŒì› ì¡°íšŒ : í• ì¸ì„ ìœ„í•´ì„œëŠ” íšŒì› ë“±ê¸‰ í•„ìš”í•¨, ê·¸ë˜ì„œ ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ì €ì¥ì†Œì—ì„œ íšŒì›ì„ ì¡°íšŒí•¨
    - í• ì¸ ì ìš© : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ì—¬ë¶€ë¥¼ í• ì¸ ì •ì±…ì— ìœ„ì„í•¨
    - ì£¼ë¬¸ ê²°ê³¼ ë°˜í™˜ : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” í• ì¸ ê²°ê³¼ë¥¼ í¬í•¨í•œ ì£¼ë¬¸ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.
    - ì°¸ê³  : ì‹¤ì œë¡œëŠ” ì£¼ë¬¸ ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ì§€ë§Œ, ê°„ë‹¨í•œ ì˜ˆì œì´ë¯€ë¡œ ë‹¨ìˆœíˆ ì£¼ë¬¸ ê²°ê³¼ë¥¼ ë°˜í™˜

- ì£¼ë¬¸ ë„ë©”ì¸ ì—­í• ê³¼ êµ¬í˜„
    
    <img width="529" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 41 53" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/37e61793-3f9d-42e6-a0a0-6e47fbd628f2">
    
    - ì—­í• (ì¸í„°í˜ì´ìŠ¤)ë¥¼ ë¨¼ì € ë§Œë“¤ê³ , êµ¬í˜„ì²´(impl)ì„ ë§Œë“¦
    - í• ì¸ ì •ì±…ë„ ë°”ë€” ìˆ˜ ìˆìŒ(ì •ì•¡ or ì •ë¥ ) â†’ ì—­í• ê³¼ êµ¬í˜„ì²´ë¡œ ë¶„ë¦¬
    
- ì£¼ë¬¸ ë„ë©”ì¸ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨(ê°ì²´ ë ˆë²¨ë¡œ êµ¬í˜„)
    
    <img width="536" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 43 43" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/78d0342d-15e2-480c-95f6-b15e155d3e96">
    

- ì£¼ë¬¸ ë„ë©”ì¸ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨
    
    <img width="526" alt="%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-04-15_11 44 43" src="https://github.com/SOPT-34th-Spring-Study/spring-study-code/assets/70939232/0d9dd84f-7cf0-453a-a881-da6495ccb206">
    

## ì£¼ë¬¸ê³¼ í• ì¸ì •ì±… ê°œë°œ

- discount íŒ¨í‚¤ì§€
    - DiscountPolicy(`interface`)
        
        ```java
        package hello.core.discount;
        
        import hello.core.member.Member;
        
        public interface DiscountPolicy {
        
            int discount(Member member, int price);
        }
        
        ```
        
    - FixDiscountPolicy(`class`, DiscountPolicy êµ¬í˜„ì²´)
        
        ```java
        package hello.core.discount;
        
        import hello.core.member.Grade;
        import hello.core.member.Member;
        
        public class FixDiscountPolicy implements DiscountPolicy {
        
            private int discountFixAmount = 1000; //1000ì› í• 
            @Override
            public int discount(Member member, int price) {
                if(member.getGrade() == Grade.VIP) {
                    return discountFixAmount;
                } else {
                    return 0;
                }
            }
        }
        
        ```
        

- order íŒ¨í‚¤ì§€
    - Order(`class`)
        
        ```java
        package hello.core.order;
        
        public class Order {
            private Long memberId;
            private String memberName;
            private int itemPrice;
            private int discountPrice;
        
            public Order(Long memberId, String memberName, int itemPrice, int discountPrice) {
                this.memberId = memberId;
                this.memberName = memberName;
                this.itemPrice = itemPrice;
                this.discountPrice = discountPrice;
            }
        
            public int calculatePrice() {
                return itemPrice - discountPrice;
            }
        
            public Long getMemberId() {
                return memberId;
            }
        
            public void setMemberId(Long memberId) {
                this.memberId = memberId;
            }
        
            public String getMemberName() {
                return memberName;
            }
        
            public void setMemberName(String memberName) {
                this.memberName = memberName;
            }
        
            public int getItemPrice() {
                return itemPrice;
            }
        
            public void setItemPrice(int itemPrice) {
                this.itemPrice = itemPrice;
            }
        
            public int getDiscountPrice() {
                return discountPrice;
            }
        
            public void setDiscountPrice(int discountPrice) {
                this.discountPrice = discountPrice;
            }
        
            @Override
            public String toString() {
                return "Order{" +
                        "memberId=" + memberId +
                        ", memberName='" + memberName + '\'' +
                        ", itemPrice=" + itemPrice +
                        ", discountPrice=" + discountPrice +
                        '}';
            }
        }
        
        ```
        
    - OrderService(`interface`)
        
        ```java
        package hello.core.order;
        
        public interface OrderService {
            Order createOrder(Long memberId, String itemName, int itemPrice);
        }
        
        ```
        
    - OrderServiceImpl(`class`, OrderService êµ¬í˜„ì²´)
        
        ```java
        package hello.core.order;
        
        import hello.core.discount.DiscountPolicy;
        import hello.core.discount.FixDiscountPolicy;
        import hello.core.member.Member;
        import hello.core.member.MemberRepository;
        import hello.core.member.MemoryMemberRepository;
        
        public class OrderServiceImpl implements OrderService {
        
            private final MemberRepository memberRepository = new MemoryMemberRepository();
            private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
        
            @Override
            public Order createOrder(Long memberId, String itemName, int itemPrice) {
        
                Member member = memberRepository.findById(memberId);
                int discountPrice = discountPolicy.discount(member, itemPrice);
        
                return new Order(memberId, itemName, itemPrice, discountPrice);
            }
        }
        
        ```
        
        - discountPolicyê°€ ìˆì–´ì„œ ë‹¨ì¼ì±…ì„ì›ì¹™ì´ ì˜ ì§€ì¼œì§
            - í• ì¸ì— ëŒ€í•œ ë³€ê²½ì´ ë“¤ì–´ì™€ë„ orderserviceì—ì„œ ë³€ê²½ì´ ì—†ê³ , discountPolicyë§Œ ìˆ˜ì •í•˜ë©´ ë¨
            

- orderService í…ŒìŠ¤íŠ¸ì½”ë“œ

```java
package hello.core.order;

import hello.core.member.*;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {

    MemberService memberService = new MemberServiceImpl();
    OrderService orderService = new OrderServiceImpl();

    @Test
    void createOrder() {
        Long memberId = 1L;
        Member memberA = new Member(memberId, "memberA", Grade.VIP);
        memberService.join(memberA);

        Order order = orderService.createOrder(memberId, "itemA", 10000);
        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);

    }
}

```